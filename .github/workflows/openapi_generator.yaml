name: openapi_generator
on:
  push:
    branches:
      - openapi-generator
jobs:
  tag_repo:
    name: Get runner id and tag the current code snapshot
    runs-on: ubuntu-latest
    steps:
      - name: Checkout current client
        uses: actions/checkout@v2
        with:
          ref: master
          path: client
      - name: checkout openapi specification
        uses: actions/checkout@v2
        with:
          path: generator
      - name: Update client code
        run: |
            version=$(cat generator/version.txt)
            generator/create.sh
      - name: Tag and push current repo code
        run: |
          cd generator
          git add --all
          git commit -m 'next version'
          git tag $version
          git push origin $version